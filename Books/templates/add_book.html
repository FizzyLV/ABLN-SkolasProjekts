{% load static %}
{% load compress %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Neliela biblotēkas sistēma.">
    <title>Add Book - ABLŅ</title>
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="stylesheet" href="{% static 'Books/css/forms.css' %}">
</head>
</head>
<body>
    {% include 'navbar.html' %}

    <div class="container">
        <div class="page-header">
            <a href="{% url 'home' %}" class="back-link">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
                Back to Library
            </a>
            <h1 class="page-title">Add New Book</h1>
        </div>

        <div class="form-container">
            {% if errors.general %}
            <div class="general-error">
                {{ errors.general }}
            </div>
            {% endif %}

            <form method="POST" action="{% url 'add_book' %}">
                {% csrf_token %}

                <div class="form-group">
                    <label for="title" class="form-label required">Book Title</label>
                    <input 
                        type="text" 
                        id="title" 
                        name="title" 
                        class="form-input {% if errors.title %}error{% endif %}"
                        value="{{ data.title }}"
                        required
                    >
                    {% if errors.title %}
                    <div class="form-error">{{ errors.title }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="isbn" class="form-label required">ISBN</label>
                    <input 
                        type="text" 
                        id="isbn" 
                        name="isbn" 
                        class="form-input {% if errors.isbn %}error{% endif %}"
                        value="{{ data.isbn }}"
                        maxlength="13"
                        required
                    >
                    {% if errors.isbn %}
                    <div class="form-error">{{ errors.isbn }}</div>
                    {% else %}
                    <div class="form-help">Enter the 13-digit ISBN number</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="author" class="form-label required">Author</label>
                    <select 
                        id="author" 
                        name="author" 
                        class="form-select {% if errors.author %}error{% endif %}"
                        required
                    >
                        <option value="">Select an author</option>
                        {% for author in authors %}
                        <option value="{{ author.AuthorID }}" {% if data.author == author.AuthorID|stringformat:"s" %}selected{% endif %}>
                            {{ author.FirstName }} {{ author.LastName }}
                        </option>
                        {% endfor %}
                    </select>
                    {% if errors.author %}
                    <div class="form-error">{{ errors.author }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="genre" class="form-label required">Genre</label>
                    <select 
                        id="genre" 
                        name="genre" 
                        class="form-select {% if errors.genre %}error{% endif %}"
                        required
                    >
                        <option value="">Select a genre</option>
                        {% for genre in genres %}
                        <option value="{{ genre.GenreID }}" {% if data.genre == genre.GenreID|stringformat:"s" %}selected{% endif %}>
                            {{ genre.Name }}
                        </option>
                        {% endfor %}
                    </select>
                    {% if errors.genre %}
                    <div class="form-error">{{ errors.genre }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="publication_date" class="form-label">Publication Date</label>
                    <input 
                        type="date" 
                        id="publication_date" 
                        name="publication_date" 
                        class="form-input"
                        value="{{ data.publication_date }}"
                    >
                    <div class="form-help">Optional - leave blank if unknown</div>
                </div>

                <div class="form-group">
                    <label for="cover_url" class="form-label">Cover Image URL</label>
                    <input 
                        type="url" 
                        id="cover_url" 
                        name="cover_url" 
                        class="form-input"
                        value="{{ data.cover_url }}"
                        placeholder="https://example.com/cover.jpg"
                    >
                    <div class="form-help">Optional - URL to the book cover image</div>
                </div>

                <div class="form-group">
                    <label for="num_copies" class="form-label required">Number of Physical Copies</label>
                    <input 
                        type="number" 
                        id="num_copies" 
                        name="num_copies" 
                        class="form-input {% if errors.num_copies %}error{% endif %}"
                        value="{{ data.num_copies|default:'1' }}"
                        min="1"
                        required
                    >
                    {% if errors.num_copies %}
                    <div class="form-error">{{ errors.num_copies }}</div>
                    {% else %}
                    <div class="form-help">How many physical copies of this book to add to the library</div>
                    {% endif %}
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Add Book</button>
                    <a href="{% url 'home' %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</body>
</html>